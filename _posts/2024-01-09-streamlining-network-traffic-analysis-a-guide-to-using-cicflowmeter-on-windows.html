---
layout: post
title: "Streamlining Network Traffic Analysis: A Guide to Using CICFlowMeter on Windows"
date: 2024-01-09
category: java
---
<h3>Introduction</h3>

<p>In the intricate world of network security and traffic analysis, having the right tools is essential for professionals and enthusiasts alike. 
	One such indispensable tool is <a href="https://github.com/ahlashkari/CICFlowMeter">CICFlowMeter</a>, a powerful network traffic flow generator widely recognized in the cybersecurity community. This open-source tool, available on GitHub, is particularly known for its versatility and depth in analyzing network flows, making it a valuable asset for anyone keen on understanding and securing their network environment.</p>

<p>In this blog post, we will delve into the specifics of running <a href="https://github.com/ahlashkari/CICFlowMeter">CICFlowMeter</a> on a Windows platform. 
	Windows, with its widespread usage and unique system architecture, presents specific challenges and opportunities for network traffic analysis. 
	We aim to simplify these complexities by providing a step-by-step guide on how to effectively deploy and utilize <a href="https://github.com/ahlashkari/CICFlowMeter">CICFlowMeter</a> in a Windows environment. Whether you are a cybersecurity professional, a network administrator, or just a tech enthusiast, this guide is designed to equip you with the knowledge and skills needed to leverage <a href="https://github.com/ahlashkari/CICFlowMeter">CICFlowMeter</a> for comprehensive network analysis on Windows systems.</p>

<p>Stay tuned as we embark on this technical journey, unraveling the nuances of <a href="https://github.com/ahlashkari/CICFlowMeter">CICFlowMeter</a> and harnessing its full potential to enhance your network analysis capabilities.</p>

<h3>Running CICFlowMeter on Windows: A Comprehensive Guide</h3>

Network traffic analysis is crucial for understanding and securing digital environments. <a href="https://github.com/ahlashkari/CICFlowMeter">CICFlowMeter</a>, a renowned Java-based tool for network traffic flow analysis, has become a go-to solution for many researchers. This blog post will guide you through the process of setting up and running CICFlowMeter on a Windows system.

<ol>
	<li><h4>Install Java and JDK</h4>
	<p><a href="https://github.com/ahlashkari/CICFlowMeter">CICFlowMeter</a> is written in Java, so the first step is to install Java and the Java Development Kit (JDK). For this setup, I used:</p>
	<ul>
		<li>Java Version 8 Update 381</li>
		<li>JDK Package: jdk-21_windows-x64_bin.exe</li>
	</ul>
	<p>You can download these from the official Java website. Ensure that you install the correct version for your Windows operating system.</p>
	</li>
	<li><h4>Install IntelliJ IDEA Community Edition</h4>
		<p>To compile <a href="https://github.com/ahlashkari/CICFlowMeter">CICFlowMeter</a>, you need an Integrated Development Environment (IDE). 
			IntelliJ IDEA Community Edition is a robust choice for this purpose. Download it from <a href="https://www.jetbrains.com/idea/download/?section=windows">JetBrains' official site</a>.
		</p>
	</li>
	<li><h4>Install Maven</h4>
		<p>Maven is a build automation tool used primarily for Java projects. 
			Download apache-maven-3.9.6-bin.zip from the <a href="https://maven.apache.org/download.cgi">Maven official website</a>. 
			Follow the installation steps provided in this detailed guide: <a href="https://phoenixnap.com/kb/install-maven-windows">Install Maven on Windows</a>.
		</p>
	</li>
	<li><h4>Install Gradle</h4>
		<p>
			Gradle is another powerful tool that automates the building, testing, deployment, and more of software packages. 
			Download gradle-8.5-bin.zip and follow the installation steps found at <a href="https://gradle.org/install/">Gradle Installation Guide</a>.
		</p>
	</li>
	<li><h4>Install WinPcap</h4>
		<p>
			CICFlowMeter requires packet capturing capabilities, provided by WinPcap. 
			Download npcap-1.78.exe from <a href="https://npcap.com/">Npcap official site</a>. 
			Make sure to enable the "Install Npcap in WinPcap-API-compatible Mode" option during installation.
		</p>
	</li>
	<li><h4>Open the CICFlowMeter Project in IntelliJ IDEA</h4>
		<p>
			Once IntelliJ IDEA is installed, open the CICFlowMeter project folder within the IDE.
		</p>
	</li>
	<li><h4>Configure Maven in IntelliJ IDEA</h4>
		<p>
			Navigate to File -> Settings -> Build, Execution, Deployment -> Build Tools -> Maven. 
			Change the Maven home directory to the folder where you installed Maven. Click 'OK' to save these settings.
		</p>
	</li>
	<li><h4>Add Jnetpcap to the Project</h4>
		<p>
			Jnetpcap is essential for packet capturing in CICFlowMeter. 
			In IntelliJ IDEA, go to File -> Project Structure -> Modules. 
			Then, choose "Add Jars and Directories" and add jnetpcap.dll and jnetpcap.jar from the &lt;project folder&gt;/jnetpcap/win/jnetpcap-1.4.r1425 directory.
			
		</p>
		<br><img alt="IntelliJ IDEA Add Jars and Directories" src="/assets/cicflowmeter-3.png">
	</li>
	<li><h4>Compile with Gradle</h4>
		<p>
			To compile the project, use Gradle. 
			Click on the Execute Gradle Task icon on the right side of IntelliJ IDEA to run gradle distZip. 
			After successful compilation, you'll find CICFlowMeter4.0.zip in the &lt;project folder&gt;\build\distributions directory.
		</p>
		<br><img alt="IntelliJ IDEA Execute Gradle Task" src="/assets/cicflowmeter-2.png">
	</li>
	<li><h4>Resolving Potential Errors with Kotlin Plugin (Optional)</h4>
		<p>
			In some cases, you might encounter an error like (136: unable to resolve class CommandLineArgumentProvider @ line 136, column 73. CommandLineArgumentProvider()). 
			This issue can often be resolved by disabling the Kotlin plugin in IntelliJ IDEA. 
			For detailed steps on how to do this, refer to this StackOverflow post: <a href="https://stackoverflow.com/questions/60176088/how-to-disable-kotlin-compiler-in-intellij-idea-for-maven-java-projects/60176264#60176264">Disable Kotlin Compiler in IntelliJ IDEA for Maven Java Projects</a>. 
			This issue is also discussed in the JetBrains YouTrack: <a href="https://youtrack.jetbrains.com/issue/IDEA-340299/IntelliJ-2023.3-Grails-3-fails-with-unable-to-resolve-class-CommandLineArgumentProvider">IntelliJ 2023.3 Grails 3 fails with unable to resolve class CommandLineArgumentProvider</a>.
		</p>
		<br><img alt="IntelliJ IDEA Open Module Settings" src="/assets/cicflowmeter-1.png">
	</li>
	<li><h4>Unzip and Launch CICFlowMeter</h4>
		<p>
			Once you have successfully compiled CICFlowMeter, unzip the CICFlowMeter4.0.zip file. Inside, you will find the CICFlowMeter.bat file. 
			Execute this file to open CICFlowMeter.
		</p>
	</li>
	<li><h4>Conducting Offline Pcap Analysis</h4>
		<p>
			In CICFlowMeter, navigate to NetWork -> Offline for Pcap analysis. 
			This functionality allows you to analyze network traffic captured in Pcap files. 
			The output includes a comprehensive list of extracted bi-flow features defined by a 5-tuple.
		</p>
		<br><img alt="CICFlowMeter" src="/assets/cicflowmeter.png">
	</li>
</ol>

<p>These features include:</p>

<ul>
	<li>Flow ID, Source IP, Source Port, Destination IP, Destination Port, Protocol, Timestamp</li>
	<li>Flow Duration, Total Forward and Backward Packets</li>
	<li>Total Length of Forward and Backward Packets</li>
	<li>Packet Length (Max, Min, Mean, Std) for Forward and Backward</li>
	<li>Flow Bytes/s, Flow Packets/s</li>
	<li>Inter-Arrival Time (IAT) statistics (Mean, Std, Max, Min) for Flow and individual directions (Forward, Backward)</li>
	<li>Flags (PSH, URG, ACK, etc.)</li>
	<li>Packet Size statistics</li>
	<li>Window Size</li>
	<li>Active and Idle time statistics</li>
	<li>Label (requires manual labeling or an additional program)</li>
</ul>

<p>By analyzing these features, users can gain detailed insights into network traffic behavior, which is crucial for tasks such as intrusion detection, network monitoring, and forensic analysis.</p>


<h3></h3>

<h3>Conclusion: Harnessing the Power of CICFlowMeter for Enhanced Network Analysis</h3>

<p>As we conclude this guide, it's important to reflect on the significance of CICFlowMeter in the realm of network traffic analysis. By following the steps outlined above, you now have a powerful tool at your disposal for dissecting and understanding network flows on a Windows environment. CICFlowMeter's ability to provide detailed insights into network traffic makes it an invaluable asset for cybersecurity professionals, network administrators, and technology enthusiasts.</p>

<p>The process of setting up CICFlowMeter, from installing Java, IntelliJ IDEA, Maven, and Gradle, to configuring and running the tool, might seem daunting at first. However, the effort pays off when you're able to analyze network traffic with precision and depth. Whether your goal is to enhance network security, perform forensic analysis, or simply understand network behavior, CICFlowMeter offers a comprehensive solution.</p>

<p>As with any tool, the journey doesn't end with installation and setup. The true value of CICFlowMeter lies in its application. Experiment with different pcap files, analyze various network scenarios, and explore the multitude of features it offers. The more you use CICFlowMeter, the more proficient you'll become in interpreting its outputs and leveraging its capabilities for your specific needs.</p>

<p>The field of network analysis is constantly evolving, and tools like CICFlowMeter are essential for staying ahead in this dynamic and challenging domain. Happy analyzing, and may your journey through the bytes and packets of network traffic lead to enlightening discoveries and enhanced security!</p>

<h3>History</h3>
<h3>Reference</h3>
<ol>
	<li><a href="https://github.com/ahlashkari/CICFlowMeter">CICFlowMeter</a></li>
	<li><a href="https://www.jetbrains.com/idea/download/?section=windows">JetBrains' official site</a></li>
	<li><a href="https://maven.apache.org/download.cgi">Maven official website</a></li>
	<li><a href="https://phoenixnap.com/kb/install-maven-windows">Install Maven on Windows</a></li>
	<li><a href="https://gradle.org/install/">Gradle Installation Guide</a></li>
	<li><a href="https://npcap.com/">Npcap official site</a></li>
	<li><a href="https://stackoverflow.com/questions/60176088/how-to-disable-kotlin-compiler-in-intellij-idea-for-maven-java-projects/60176264#60176264">Disable Kotlin Compiler in IntelliJ IDEA for Maven Java Projects</a></li>
	<li><a href="https://denialdoufu.medium.com/cicflowmeter%E4%BD%BF%E7%94%A8%E8%AA%AA%E6%98%8E-windows-a5342bb82f7e">CICFlowmeter使用說明(Windows)</a></li>
	<li><a href="https://chat.openai.com/">ChatGPT, personal communication, January 09, 2024</a></li>
</ol>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>